# Docker Services Quick Reference

## ðŸš€ Quick Commands

```bash
# Start everything with one command
./docker-setup.sh

# Or manually
docker compose up -d                    # Core services
docker compose --profile tools up -d    # + Management tools
```

## ðŸ“ Service Access Points

| Service               | URL/Port              | Credentials                          |
| --------------------- | --------------------- | ------------------------------------ |
| **Web App**           | http://localhost:5173 | -                                    |
| **PostgreSQL**        | localhost:5432        | splitshare / splitshare_dev_password |
| **Redis**             | localhost:6379        | redis_dev_password                   |
| **Upstash Proxy**     | http://localhost:8079 | example_token                        |
| **Mailpit**           | http://localhost:8025 | -                                    |
| **pgAdmin\***         | http://localhost:5050 | admin@admin.com / admin              |
| **Redis Commander\*** | http://localhost:8081 | -                                    |

\*Requires profile flag (--profile tools)

## ðŸ”§ Database Connection Strings

```bash
# Application (via .env)
DATABASE_URL=postgresql://splitshare:splitshare_dev_password@localhost:5432/splitshare

# Direct psql access
psql postgresql://splitshare:splitshare_dev_password@localhost:5432/splitshare

# Via docker compose
docker compose exec postgres psql -U splitshare -d splitshare
```

## ðŸ”´ Redis Configuration

### Local Development

```env
UPSTASH_REDIS_REST_URL=http://localhost:8079
UPSTASH_REDIS_REST_TOKEN=example_token
```

### Production (Upstash)

```env
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-redis-token
```

## ðŸ“§ Email Testing

All emails are captured by Mailpit and visible at http://localhost:8025

SMTP Configuration:

```env
# For development, Mailpit handles this automatically
RESEND_API_KEY=not-needed-for-mailpit
EMAIL_FROM=noreply@splitshare.local
```

## ðŸ› Error Monitoring (Sentry.io)

For error monitoring in production, sign up at https://sentry.io and configure:

```env
SENTRY_DSN=https://your-key@sentry.io/project-id
SENTRY_AUTH_TOKEN=your-auth-token
SENTRY_ORG=your-org
SENTRY_PROJECT=your-project
```

Leave `SENTRY_DSN` empty to disable error tracking in development.

## ðŸ”„ Common Operations

```bash
# View logs
docker compose logs -f                   # All services
docker compose logs -f postgres          # Specific service

# Restart service
docker compose restart postgres

# Stop all
docker compose down

# Stop and remove data (WARNING: deletes all data!)
docker compose down -v

# Check health
docker compose ps
```

## ðŸ—„ï¸ Database Operations

```bash
# Run migrations
npm run db:push

# Open Drizzle Studio
npm run db:studio

# Backup database
docker compose exec postgres pg_dump -U splitshare splitshare > backup.sql

# Restore database
docker compose exec -T postgres psql -U splitshare -d splitshare < backup.sql

# Reset database (WARNING: deletes all data!)
docker compose down -v
docker compose up -d
npm run db:push
```

## ðŸ“Š Monitoring

### PostgreSQL

- Direct: pgAdmin at http://localhost:5050 (with --profile tools)
- CLI: `docker compose exec postgres psql -U splitshare -d splitshare`

### Redis

- Direct: Redis Commander at http://localhost:8081 (with --profile tools)
- CLI: `docker compose exec redis redis-cli -a redis_dev_password`

## ðŸš¨ Troubleshooting

### Port Already in Use

```bash
# Find process using port
lsof -i :5432  # PostgreSQL
lsof -i :6379  # Redis

# Kill process or change port in docker-compose.yml
```

### Service Not Starting

```bash
# Check logs
docker compose logs [service-name]

# Check health
docker compose ps

# Restart service
docker compose restart [service-name]
```

### Database Connection Issues

```bash
# Test connection
docker compose exec postgres pg_isready -U splitshare

# Check if database exists
docker compose exec postgres psql -U splitshare -l
```

### Redis Connection Issues

```bash
# Test connection
docker compose exec redis redis-cli -a redis_dev_password ping

# Check if proxy is running
curl http://localhost:8079
```

## ðŸ“ Files Reference

- `docker-compose.yml` - Service definitions
- `.env.example` - Environment variables template
- `.env` - Your local configuration (gitignored)
- `DOCKER.md` - Comprehensive documentation
- `docker-setup.sh` - Automated setup script

## ðŸŽ¯ Next Steps

After setup:

1. Start development server: `npm run dev`
2. View emails: http://localhost:8025
3. Check database: http://localhost:5050 (with --profile tools)

For detailed documentation, see [DOCKER.md](./DOCKER.md)
